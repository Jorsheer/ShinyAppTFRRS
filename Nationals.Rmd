---
title: "Nationals.Rmd"
output: html_document
date: "2025-05-11"
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r track-ui, echo=FALSE}
inputPanel(
  selectInput("year", "Select Year:", choices = sort(unique(final_nats$Year)), selected = max(final_nats$Year)),
  selectInput("event", "Select Event:", choices = sort(unique(final_nats$Event)), selected = "60 Meters (Men)"),
  sliderInput("athletes", label = "Number of Athletes",
              min = 1, max = 50, value = 25, step = 1)
)

renderPlot({
  
  filtered_data <- final_nats |>
    filter(Year == input$year, Event == input$event)
  
  top_n <- input$athletes
  if (any(!is.na(filtered_data$Time))) {
    filtered_data <- filtered_data |>
      arrange(Time) |>
      head(top_n)
  } else if (any(!is.na(filtered_data$Mark))) {
    filtered_data <- filtered_data |>
      arrange(desc(Mark)) |>
      head(top_n)
  }
  
  if (all(is.na(filtered_data$Time)) && any(!is.na(filtered_data$Mark))) {
    barplot(
      filtered_data$Mark,
      names.arg = filtered_data$Athlete,
      las = 2,
      main = paste("Marks for", input$event),
      ylab = "Mark"
    )
  } else if (any(!is.na(filtered_data$Time))) {
    barplot(
      filtered_data$Time,
      names.arg = filtered_data$Athlete,
      las = 2,
      main = paste("Times for", input$event),
      ylab = "Time (seconds)"
    )
  } else {
    plot.new()
    text(0.5, 0.5, "No valid data for selected event", cex = 1.5)
  }
})

```


